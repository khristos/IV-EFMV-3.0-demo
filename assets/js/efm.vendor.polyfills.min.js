/*! efm-viewer v3.0.0 | (c) 2020 Illustrated Verdict | Illustrated Verdict License | https://github.com/khristos/IV-EFMV */
/*! efm-viewer v3.0.0 | (c) 2020 Illustrated Verdict | Illustrated Verdict License | https://github.com/khristos/IV-EFMV */
"use strict";var defaultInstanceSettings={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0},defaultTweenSettings={duration:1e3,delay:0,endDelay:0,easing:"easeOutElastic(1, .5)",round:0},validTransforms=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective","matrix","matrix3d"],cache={CSS:{},springs:{}};function minMax(t,e,n){return Math.min(Math.max(t,e),n)}function stringContains(t,e){return t.indexOf(e)>-1}function applyArguments(t,e){return t.apply(null,e)}var is={arr:function(t){return Array.isArray(t)},obj:function(t){return stringContains(Object.prototype.toString.call(t),"Object")},pth:function(t){return is.obj(t)&&t.hasOwnProperty("totalLength")},svg:function(t){return t instanceof SVGElement},inp:function(t){return t instanceof HTMLInputElement},dom:function(t){return t.nodeType||is.svg(t)},str:function(t){return"string"==typeof t},fnc:function(t){return"function"==typeof t},und:function(t){return void 0===t},hex:function(t){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(t)},rgb:function(t){return/^rgb/.test(t)},hsl:function(t){return/^hsl/.test(t)},col:function(t){return is.hex(t)||is.rgb(t)||is.hsl(t)},key:function(t){return!defaultInstanceSettings.hasOwnProperty(t)&&!defaultTweenSettings.hasOwnProperty(t)&&"targets"!==t&&"keyframes"!==t}};function parseEasingParameters(t){var e=/\(([^)]+)\)/.exec(t);return e?e[1].split(",").map((function(t){return parseFloat(t)})):[]}function spring(t,e){var n=parseEasingParameters(t),r=minMax(is.und(n[0])?1:n[0],.1,100),i=minMax(is.und(n[1])?100:n[1],.1,100),o=minMax(is.und(n[2])?10:n[2],.1,100),a=minMax(is.und(n[3])?0:n[3],.1,100),s=Math.sqrt(i/r),u=o/(2*Math.sqrt(i*r)),c=u<1?s*Math.sqrt(1-u*u):0,l=1,f=u<1?(u*s-a)/c:-a+s;function p(t){var n=e?e*t/1e3:t;return n=u<1?Math.exp(-n*u*s)*(l*Math.cos(c*n)+f*Math.sin(c*n)):(l+f*n)*Math.exp(-n*s),0===t||1===t?t:1-n}return e?p:function(){var e=cache.springs[t];if(e)return e;for(var n=0,r=0;;)if(1===p(n+=1/6)){if(++r>=16)break}else r=0;var i=n*(1/6)*1e3;return cache.springs[t]=i,i}}function steps(t){return void 0===t&&(t=10),function(e){return Math.ceil(minMax(e,1e-6,1)*t)*(1/t)}}var bezier=(function(){var t=11,e=1/(t-1);function n(t,e){return 1-3*e+3*t}function r(t,e){return 3*e-6*t}function i(t){return 3*t}function o(t,e,o){return((n(e,o)*t+r(e,o))*t+i(e))*t}function a(t,e,o){return 3*n(e,o)*t*t+2*r(e,o)*t+i(e)}return function(n,r,i,s){if(0<=n&&n<=1&&0<=i&&i<=1){var u=new Float32Array(t);if(n!==r||i!==s)for(var c=0;c<t;++c)u[c]=o(c*e,n,i);return function(t){return n===r&&i===s?t:0===t||1===t?t:o(l(t),r,s)}}function l(r){for(var s=0,c=1,l=t-1;c!==l&&u[c]<=r;++c)s+=e;--c;var f=s+(r-u[c])/(u[c+1]-u[c])*e,p=a(f,n,i);return p>=.001?(function(t,e,n,r){for(var i=0;i<4;++i){var s=a(e,n,r);if(0===s)return e;e-=(o(e,n,r)-t)/s}return e})(r,f,n,i):0===p?f:(function(t,e,n,r,i){var a,s,u=0;do{(a=o(s=e+(n-e)/2,r,i)-t)>0?n=s:e=s}while(Math.abs(a)>1e-7&&++u<10);return s})(r,s,s+e,n,i)}}})(),penner=(function(){var t={linear:function(){return function(t){return t}}},e={Sine:function(){return function(t){return 1-Math.cos(t*Math.PI/2)}},Circ:function(){return function(t){return 1-Math.sqrt(1-t*t)}},Back:function(){return function(t){return t*t*(3*t-2)}},Bounce:function(){return function(t){for(var e,n=4;t<((e=Math.pow(2,--n))-1)/11;);return 1/Math.pow(4,3-n)-7.5625*Math.pow((3*e-2)/22-t,2)}},Elastic:function(t,e){void 0===t&&(t=1),void 0===e&&(e=.5);var n=minMax(t,1,10),r=minMax(e,.1,2);return function(t){return 0===t||1===t?t:-n*Math.pow(2,10*(t-1))*Math.sin((t-1-r/(2*Math.PI)*Math.asin(1/n))*(2*Math.PI)/r)}}};return["Quad","Cubic","Quart","Quint","Expo"].forEach((function(t,n){e[t]=function(){return function(t){return Math.pow(t,n+2)}}})),Object.keys(e).forEach((function(n){var r=e[n];t["easeIn"+n]=r,t["easeOut"+n]=function(t,e){return function(n){return 1-r(t,e)(1-n)}},t["easeInOut"+n]=function(t,e){return function(n){return n<.5?r(t,e)(2*n)/2:1-r(t,e)(-2*n+2)/2}}})),t})();function parseEasings(t,e){if(is.fnc(t))return t;var n=t.split("(")[0],r=penner[n],i=parseEasingParameters(t);switch(n){case"spring":return spring(t,e);case"cubicBezier":return applyArguments(bezier,i);case"steps":return applyArguments(steps,i);default:return applyArguments(r,i)}}function selectString(t){try{return document.querySelectorAll(t)}catch(t){return}}function filterArray(t,e){for(var n=t.length,r=arguments.length>=2?arguments[1]:void 0,i=[],o=0;o<n;o++)if(o in t){var a=t[o];e.call(r,a,o,t)&&i.push(a)}return i}function flattenArray(t){return t.reduce((function(t,e){return t.concat(is.arr(e)?flattenArray(e):e)}),[])}function toArray(t){return is.arr(t)?t:(is.str(t)&&(t=selectString(t)||t),t instanceof NodeList||t instanceof HTMLCollection?[].slice.call(t):[t])}function arrayContains(t,e){return t.some((function(t){return t===e}))}function cloneObject(t){var e={};for(var n in t)e[n]=t[n];return e}function replaceObjectProps(t,e){var n=cloneObject(t);for(var r in t)n[r]=e.hasOwnProperty(r)?e[r]:t[r];return n}function mergeObjects(t,e){var n=cloneObject(t);for(var r in e)n[r]=is.und(t[r])?e[r]:t[r];return n}function rgbToRgba(t){var e=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec(t);return e?"rgba("+e[1]+",1)":t}function hexToRgba(t){var e=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(t,e,n,r){return e+e+n+n+r+r})),n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return"rgba("+parseInt(n[1],16)+","+parseInt(n[2],16)+","+parseInt(n[3],16)+",1)"}function hslToRgba(t){var e,n,r,i=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(t)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec(t),o=parseInt(i[1],10)/360,a=parseInt(i[2],10)/100,s=parseInt(i[3],10)/100,u=i[4]||1;function c(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t}if(0==a)e=n=r=s;else{var l=s<.5?s*(1+a):s+a-s*a,f=2*s-l;e=c(f,l,o+1/3),n=c(f,l,o),r=c(f,l,o-1/3)}return"rgba("+255*e+","+255*n+","+255*r+","+u+")"}function colorToRgb(t){return is.rgb(t)?rgbToRgba(t):is.hex(t)?hexToRgba(t):is.hsl(t)?hslToRgba(t):void 0}function getUnit(t){var e=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(t);if(e)return e[1]}function getTransformUnit(t){return stringContains(t,"translate")||"perspective"===t?"px":stringContains(t,"rotate")||stringContains(t,"skew")?"deg":void 0}function getFunctionValue(t,e){return is.fnc(t)?t(e.target,e.id,e.total):t}function getAttribute(t,e){return t.getAttribute(e)}function convertPxToUnit(t,e,n){if(arrayContains([n,"deg","rad","turn"],getUnit(e)))return e;var r=cache.CSS[e+n];if(!is.und(r))return r;var i=document.createElement(t.tagName),o=t.parentNode&&t.parentNode!==document?t.parentNode:document.body;o.appendChild(i),i.style.position="absolute",i.style.width=100+n;var a=100/i.offsetWidth;o.removeChild(i);var s=a*parseFloat(e);return cache.CSS[e+n]=s,s}function getCSSValue(t,e,n){if(e in t.style){var r=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),i=t.style[e]||getComputedStyle(t).getPropertyValue(r)||"0";return n?convertPxToUnit(t,i,n):i}}function getAnimationType(t,e){return is.dom(t)&&!is.inp(t)&&(getAttribute(t,e)||is.svg(t)&&t[e])?"attribute":is.dom(t)&&arrayContains(validTransforms,e)?"transform":is.dom(t)&&"transform"!==e&&getCSSValue(t,e)?"css":null!=t[e]?"object":void 0}function getElementTransforms(t){if(is.dom(t)){for(var e,n=t.style.transform||"",r=/(\w+)\(([^)]*)\)/g,i=new Map;e=r.exec(n);)i.set(e[1],e[2]);return i}}function getTransformValue(t,e,n,r){var i=stringContains(e,"scale")?1:0+getTransformUnit(e),o=getElementTransforms(t).get(e)||i;return n&&(n.transforms.list.set(e,o),n.transforms.last=e),r?convertPxToUnit(t,o,r):o}function getOriginalTargetValue(t,e,n,r){switch(getAnimationType(t,e)){case"transform":return getTransformValue(t,e,r,n);case"css":return getCSSValue(t,e,n);case"attribute":return getAttribute(t,e);default:return t[e]||0}}function getRelativeValue(t,e){var n=/^(\*=|\+=|-=)/.exec(t);if(!n)return t;var r=getUnit(t)||0,i=parseFloat(e),o=parseFloat(t.replace(n[0],""));switch(n[0][0]){case"+":return i+o+r;case"-":return i-o+r;case"*":return i*o+r}}function validateValue(t,e){if(is.col(t))return colorToRgb(t);if(/\s/g.test(t))return t;var n=getUnit(t),r=n?t.substr(0,t.length-n.length):t;return e?r+e:r}function getDistance(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function getCircleLength(t){return 2*Math.PI*getAttribute(t,"r")}function getRectLength(t){return 2*getAttribute(t,"width")+2*getAttribute(t,"height")}function getLineLength(t){return getDistance({x:getAttribute(t,"x1"),y:getAttribute(t,"y1")},{x:getAttribute(t,"x2"),y:getAttribute(t,"y2")})}function getPolylineLength(t){for(var e,n=t.points,r=0,i=0;i<n.numberOfItems;i++){var o=n.getItem(i);i>0&&(r+=getDistance(e,o)),e=o}return r}function getPolygonLength(t){var e=t.points;return getPolylineLength(t)+getDistance(e.getItem(e.numberOfItems-1),e.getItem(0))}function getTotalLength(t){if(t.getTotalLength)return t.getTotalLength();switch(t.tagName.toLowerCase()){case"circle":return getCircleLength(t);case"rect":return getRectLength(t);case"line":return getLineLength(t);case"polyline":return getPolylineLength(t);case"polygon":return getPolygonLength(t)}}function setDashoffset(t){var e=getTotalLength(t);return t.setAttribute("stroke-dasharray",e),e}function getParentSvgEl(t){for(var e=t.parentNode;is.svg(e)&&is.svg(e.parentNode);)e=e.parentNode;return e}function getParentSvg(t,e){var n=e||{},r=n.el||getParentSvgEl(t),i=r.getBoundingClientRect(),o=getAttribute(r,"viewBox"),a=i.width,s=i.height,u=n.viewBox||(o?o.split(" "):[0,0,a,s]);return{el:r,viewBox:u,x:u[0]/1,y:u[1]/1,w:a/u[2],h:s/u[3]}}function getPath(t,e){var n=is.str(t)?selectString(t)[0]:t,r=e||100;return function(t){return{property:t,el:n,svg:getParentSvg(n),totalLength:getTotalLength(n)*(r/100)}}}function getPathProgress(t,e){function n(n){void 0===n&&(n=0);var r=e+n>=1?e+n:0;return t.el.getPointAtLength(r)}var r=getParentSvg(t.el,t.svg),i=n(),o=n(-1),a=n(1);switch(t.property){case"x":return(i.x-r.x)*r.w;case"y":return(i.y-r.y)*r.h;case"angle":return 180*Math.atan2(a.y-o.y,a.x-o.x)/Math.PI}}function decomposeValue(t,e){var n=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?/g,r=validateValue(is.pth(t)?t.totalLength:t,e)+"";return{original:r,numbers:r.match(n)?r.match(n).map(Number):[0],strings:is.str(t)||e?r.split(n):[]}}function parseTargets(t){return filterArray(t?flattenArray(is.arr(t)?t.map(toArray):toArray(t)):[],(function(t,e,n){return n.indexOf(t)===e}))}function getAnimatables(t){var e=parseTargets(t);return e.map((function(t,n){return{target:t,id:n,total:e.length,transforms:{list:getElementTransforms(t)}}}))}function normalizePropertyTweens(t,e){var n=cloneObject(e);if(/^spring/.test(n.easing)&&(n.duration=spring(n.easing)),is.arr(t)){var r=t.length;2===r&&!is.obj(t[0])?t={value:t}:is.fnc(e.duration)||(n.duration=e.duration/r)}var i=is.arr(t)?t:[t];return i.map((function(t,n){var r=is.obj(t)&&!is.pth(t)?t:{value:t};return is.und(r.delay)&&(r.delay=n?0:e.delay),is.und(r.endDelay)&&(r.endDelay=n===i.length-1?e.endDelay:0),r})).map((function(t){return mergeObjects(t,n)}))}function flattenKeyframes(t){for(var e=filterArray(flattenArray(t.map((function(t){return Object.keys(t)}))),(function(t){return is.key(t)})).reduce((function(t,e){return t.indexOf(e)<0&&t.push(e),t}),[]),n={},r=function(r){var i=e[r];n[i]=t.map((function(t){var e={};for(var n in t)is.key(n)?n==i&&(e.value=t[n]):e[n]=t[n];return e}))},i=0;i<e.length;i++)r(i);return n}function getProperties(t,e){var n=[],r=e.keyframes;for(var i in r&&(e=mergeObjects(flattenKeyframes(r),e)),e)is.key(i)&&n.push({name:i,tweens:normalizePropertyTweens(e[i],t)});return n}function normalizeTweenValues(t,e){var n={};for(var r in t){var i=getFunctionValue(t[r],e);is.arr(i)&&1===(i=i.map((function(t){return getFunctionValue(t,e)}))).length&&(i=i[0]),n[r]=i}return n.duration=parseFloat(n.duration),n.delay=parseFloat(n.delay),n}function normalizeTweens(t,e){var n;return t.tweens.map((function(r){var i=normalizeTweenValues(r,e),o=i.value,a=is.arr(o)?o[1]:o,s=getUnit(a),u=getOriginalTargetValue(e.target,t.name,s,e),c=n?n.to.original:u,l=is.arr(o)?o[0]:c,f=getUnit(l)||getUnit(u),p=s||f;return is.und(a)&&(a=c),i.from=decomposeValue(l,p),i.to=decomposeValue(getRelativeValue(a,l),p),i.start=n?n.end:0,i.end=i.start+i.delay+i.duration+i.endDelay,i.easing=parseEasings(i.easing,i.duration),i.isPath=is.pth(o),i.isColor=is.col(i.from.original),i.isColor&&(i.round=1),n=i,i}))}var setProgressValue={css:function(t,e,n){return t.style[e]=n},attribute:function(t,e,n){return t.setAttribute(e,n)},object:function(t,e,n){return t[e]=n},transform:function(t,e,n,r,i){if(r.list.set(e,n),e===r.last||i){var o="";r.list.forEach((function(t,e){o+=e+"("+t+") "})),t.style.transform=o}}};function setTargetsValue(t,e){getAnimatables(t).forEach((function(t){for(var n in e){var r=getFunctionValue(e[n],t),i=t.target,o=getUnit(r),a=getOriginalTargetValue(i,n,o,t),s=getRelativeValue(validateValue(r,o||getUnit(a)),a),u=getAnimationType(i,n);setProgressValue[u](i,n,s,t.transforms,!0)}}))}function createAnimation(t,e){var n=getAnimationType(t.target,e.name);if(n){var r=normalizeTweens(e,t),i=r[r.length-1];return{type:n,property:e.name,animatable:t,tweens:r,duration:i.end,delay:r[0].delay,endDelay:i.endDelay}}}function getAnimations(t,e){return filterArray(flattenArray(t.map((function(t){return e.map((function(e){return createAnimation(t,e)}))}))),(function(t){return!is.und(t)}))}function getInstanceTimings(t,e){var n=t.length,r=function(t){return t.timelineOffset?t.timelineOffset:0},i={};return i.duration=n?Math.max.apply(Math,t.map((function(t){return r(t)+t.duration}))):e.duration,i.delay=n?Math.min.apply(Math,t.map((function(t){return r(t)+t.delay}))):e.delay,i.endDelay=n?i.duration-Math.max.apply(Math,t.map((function(t){return r(t)+t.duration-t.endDelay}))):e.endDelay,i}var instanceID=0;function createNewInstance(t){var e=replaceObjectProps(defaultInstanceSettings,t),n=replaceObjectProps(defaultTweenSettings,t),r=getProperties(n,t),i=getAnimatables(t.targets),o=getAnimations(i,r),a=getInstanceTimings(o,n),s=instanceID;return instanceID++,mergeObjects(e,{id:s,children:[],animatables:i,animations:o,duration:a.duration,delay:a.delay,endDelay:a.endDelay})}var raf,activeInstances=[],pausedInstances=[],engine=(function(){function t(){raf=requestAnimationFrame(e)}function e(e){var n=activeInstances.length;if(n){for(var r=0;r<n;){var i=activeInstances[r];if(i.paused){var o=activeInstances.indexOf(i);o>-1&&(activeInstances.splice(o,1),n=activeInstances.length)}else i.tick(e);r++}t()}else raf=cancelAnimationFrame(raf)}return t})();function handleVisibilityChange(){document.hidden?(activeInstances.forEach((function(t){return t.pause()})),pausedInstances=activeInstances.slice(0),anime.running=activeInstances=[]):pausedInstances.forEach((function(t){return t.play()}))}function anime(t){void 0===t&&(t={});var e,n=0,r=0,i=0,o=0,a=null;function s(t){var e=window.Promise&&new Promise((function(t){return a=t}));return t.finished=e,e}var u=createNewInstance(t);s(u);function c(){var t=u.direction;"alternate"!==t&&(u.direction="normal"!==t?"normal":"reverse"),u.reversed=!u.reversed,e.forEach((function(t){return t.reversed=u.reversed}))}function l(t){return u.reversed?u.duration-t:t}function f(){n=0,r=l(u.currentTime)*(1/anime.speed)}function p(t,e){e&&e.seek(t-e.timelineOffset)}function h(t){for(var e=0,n=u.animations,r=n.length;e<r;){var i=n[e],o=i.animatable,a=i.tweens,s=a.length-1,c=a[s];s&&(c=filterArray(a,(function(e){return t<e.end}))[0]||c);for(var l=minMax(t-c.start-c.delay,0,c.duration)/c.duration,f=isNaN(l)?1:c.easing(l),p=c.to.strings,h=c.round,d=[],g=c.to.numbers.length,m=void 0,v=0;v<g;v++){var y=void 0,b=c.to.numbers[v],w=c.from.numbers[v]||0;y=c.isPath?getPathProgress(c.value,f*b):w+f*(b-w),h&&(c.isColor&&v>2||(y=Math.round(y*h)/h)),d.push(y)}var x=p.length;if(x){m=p[0];for(var E=0;E<x;E++){p[E];var T=p[E+1],O=d[E];isNaN(O)||(m+=T?O+T:O+" ")}}else m=d[0];setProgressValue[i.type](o.target,i.property,m,o.transforms),i.currentValue=m,e++}}function d(t){u[t]&&!u.passThrough&&u[t](u)}function g(t){var f=u.duration,g=u.delay,m=f-u.endDelay,v=l(t);u.progress=minMax(v/f*100,0,100),u.reversePlayback=v<u.currentTime,e&&(function(t){if(u.reversePlayback)for(var n=o;n--;)p(t,e[n]);else for(var r=0;r<o;r++)p(t,e[r])})(v),!u.began&&u.currentTime>0&&(u.began=!0,d("begin")),!u.loopBegan&&u.currentTime>0&&(u.loopBegan=!0,d("loopBegin")),v<=g&&0!==u.currentTime&&h(0),(v>=m&&u.currentTime!==f||!f)&&h(f),v>g&&v<m?(u.changeBegan||(u.changeBegan=!0,u.changeCompleted=!1,d("changeBegin")),d("change"),h(v)):u.changeBegan&&(u.changeCompleted=!0,u.changeBegan=!1,d("changeComplete")),u.currentTime=minMax(v,0,f),u.began&&d("update"),t>=f&&(r=0,u.remaining&&!0!==u.remaining&&u.remaining--,u.remaining?(n=i,d("loopComplete"),u.loopBegan=!1,"alternate"===u.direction&&c()):(u.paused=!0,u.completed||(u.completed=!0,d("loopComplete"),d("complete"),!u.passThrough&&"Promise"in window&&(a(),s(u)))))}return u.reset=function(){var t=u.direction;u.passThrough=!1,u.currentTime=0,u.progress=0,u.paused=!0,u.began=!1,u.loopBegan=!1,u.changeBegan=!1,u.completed=!1,u.changeCompleted=!1,u.reversePlayback=!1,u.reversed="reverse"===t,u.remaining=u.loop,e=u.children;for(var n=o=e.length;n--;)u.children[n].reset();(u.reversed&&!0!==u.loop||"alternate"===t&&1===u.loop)&&u.remaining++,h(u.reversed?u.duration:0)},u.set=function(t,e){return setTargetsValue(t,e),u},u.tick=function(t){i=t,n||(n=i),g((i+(r-n))*anime.speed)},u.seek=function(t){g(l(t))},u.pause=function(){u.paused=!0,f()},u.play=function(){u.paused&&(u.completed&&u.reset(),u.paused=!1,activeInstances.push(u),f(),raf||engine())},u.reverse=function(){c(),u.completed=!u.reversed,f()},u.restart=function(){u.reset(),u.play()},u.reset(),u.autoplay&&u.play(),u}function removeTargetsFromAnimations(t,e){for(var n=e.length;n--;)arrayContains(t,e[n].animatable.target)&&e.splice(n,1)}function removeTargets(t){for(var e=parseTargets(t),n=activeInstances.length;n--;){var r=activeInstances[n],i=r.animations,o=r.children;removeTargetsFromAnimations(e,i);for(var a=o.length;a--;){var s=o[a],u=s.animations;removeTargetsFromAnimations(e,u),u.length||s.children.length||o.splice(a,1)}i.length||o.length||r.pause()}}function stagger(t,e){void 0===e&&(e={});var n=e.direction||"normal",r=e.easing?parseEasings(e.easing):null,i=e.grid,o=e.axis,a=e.from||0,s="first"===a,u="center"===a,c="last"===a,l=is.arr(t),f=l?parseFloat(t[0]):parseFloat(t),p=l?parseFloat(t[1]):0,h=getUnit(l?t[1]:t)||0,d=e.start||0+(l?f:0),g=[],m=0;return function(t,e,v){if(s&&(a=0),u&&(a=(v-1)/2),c&&(a=v-1),!g.length){for(var y=0;y<v;y++){if(i){var b=u?(i[0]-1)/2:a%i[0],w=u?(i[1]-1)/2:Math.floor(a/i[0]),x=b-y%i[0],E=w-Math.floor(y/i[0]),T=Math.sqrt(x*x+E*E);"x"===o&&(T=-x),"y"===o&&(T=-E),g.push(T)}else g.push(Math.abs(a-y));m=Math.max.apply(Math,g)}r&&(g=g.map((function(t){return r(t/m)*m}))),"reverse"===n&&(g=g.map((function(t){return o?t<0?-1*t:-t:Math.abs(m-t)})))}return d+(l?(p-f)/m:f)*(Math.round(100*g[e])/100)+h}}function timeline(t){void 0===t&&(t={});var e=anime(t);return e.duration=0,e.add=function(n,r){var i=activeInstances.indexOf(e),o=e.children;function a(t){t.passThrough=!0}i>-1&&activeInstances.splice(i,1);for(var s=0;s<o.length;s++)a(o[s]);var u=mergeObjects(n,replaceObjectProps(defaultTweenSettings,t));u.targets=u.targets||t.targets;var c=e.duration;u.autoplay=!1,u.direction=e.direction,u.timelineOffset=is.und(r)?c:getRelativeValue(r,c),a(e),e.seek(u.timelineOffset);var l=anime(u);a(l),o.push(l);var f=getInstanceTimings(o,t);return e.delay=f.delay,e.endDelay=f.endDelay,e.duration=f.duration,e.seek(0),e.reset(),e.autoplay&&e.play(),e},e}"undefined"!=typeof document&&document.addEventListener("visibilitychange",handleVisibilityChange),anime.version="3.2.0",anime.speed=1,anime.running=activeInstances,anime.remove=removeTargets,anime.get=getOriginalTargetValue,anime.set=setTargetsValue,anime.convertPx=convertPxToUnit,anime.path=getPath,anime.setDashoffset=setDashoffset,anime.stagger=stagger,anime.timeline=timeline,anime.easing=parseEasings,anime.penner=penner,anime.random=function(t,e){return Math.floor(Math.random()*(e-t+1))+t},"undefined"!=typeof module&&(module.exports=anime)
/*!
 * atomicjs v4.4.0
 * A tiny, Promise-based vanilla JS Ajax/HTTP plugin with 
 * great browser support.
 * (c) 2019 Chris Ferdinandi
 * MIT License
 * https://github.com/cferdinandi/atomic
 */,(function(t,e){"function"==typeof define&&define.amd?define([],(function(){return e(t)})):"object"==typeof exports?module.exports=e(t):window.atomic=e(t)})("undefined"!=typeof global?global:"undefined"!=typeof window?window:this,(function(t){var e,n={method:"GET",username:null,password:null,data:{},headers:{"Content-type":"application/x-www-form-urlencoded"},responseType:"text",timeout:null,withCredentials:!1},r=function(){for(var t={},e=function(e){for(var n in e)e.hasOwnProperty(n)&&("[object Object]"===Object.prototype.toString.call(e[n])?t[n]=r(t[n],e[n]):t[n]=e[n])},n=0;n<arguments.length;n++){var i=arguments[n];e(i)}return t},i=function(t){var n=new XMLHttpRequest,r=new Promise((function(r,i){for(var o in n.onreadystatechange=function(){4===n.readyState&&(n.status>=200&&n.status<300?r(function(t){var n;if("text"!==e.responseType&&""!==e.responseType)return{data:t.response,xhr:t};try{n=JSON.parse(t.responseText)}catch(e){n=t.responseText}return{data:n,xhr:t}}(n)):i({status:n.status,statusText:n.statusText,responseText:n.responseText}))},n.open(e.method,t,!0,e.username,e.password),n.responseType=e.responseType,e.headers)e.headers.hasOwnProperty(o)&&n.setRequestHeader(o,e.headers[o]);e.timeout&&(n.timeout=e.timeout,n.ontimeout=function(t){i({status:408,statusText:"Request timeout"})}),e.withCredentials&&(n.withCredentials=!0),n.send(function(t){if("string"==typeof t||"[object FormData]"===Object.prototype.toString.call(t))return t;if(/application\/json/i.test(e.headers["Content-type"])||"[object Array]"===Object.prototype.toString.call(t))return JSON.stringify(t);var n=[];for(var r in t)t.hasOwnProperty(r)&&n.push(encodeURIComponent(r)+"="+encodeURIComponent(t[r]));return n.join("&")}(e.data))}));return r.cancel=function(){n.abort()},r};return function(o,a){if(!("XMLHttpRequest"in t&&"JSON"in t&&"Promise"in t))throw"Atomic: This browser does not support the methods used in this plugin.";return e=r(n,a||{}),i(o)}})),
/*!
 * eventslibjs v1.2.0
 * A tiny event delegation helper library.
 * (c) 2019 Chris Ferdinandi
 * MIT License
 * http://github.com/cferdinandi/events
 */
(function(t,e){"function"==typeof define&&define.amd?define([],(function(){return e(t)})):"object"==typeof exports?module.exports=e(t):t.events=e(t)})("undefined"!=typeof global?global:"undefined"!=typeof window?window:this,(function(t){var e={},n={},r=function(e){n[e.type]&&n[e.type].forEach((function(n){var r,i;(r=e.target,i=n.selector,["*","window","document","document.documentElement",t,document,document.documentElement].indexOf(i)>-1||("string"!=typeof i&&i.contains?i===r||i.contains(r):r.closest(i)))&&n.callback(e)}))};return e.on=function(e,i,o){i&&o&&e.split(",").forEach((function(e){e=e.trim(),n[e]||(n[e]=[],t.addEventListener(e,r,!0)),n[e].push({selector:i,callback:o})}))},e.off=function(e,i,o){e.split(",").forEach((function(e){if(e=e.trim(),n[e]){if(n[e].length<2||!i)return delete n[e],void t.removeEventListener(e,r,!0);var a=(function(t,e,n){for(var r=0;r<t.length;r++)if(t[r].selector===e&&t[r].callback.toString()===n.toString())return r;return-1})(n[e],i,o);a<0||n[e].splice(a,1)}}))},e.once=function(t,n,r){e.on(t,n,(function i(o){r(o),e.off(t,n,i)}))},e.get=function(){var t={};for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e]);return t},e})),
/*!
 * imagesLoaded PACKAGED v4.1.4
 * JavaScript is all like "You images are done yet or what?"
 * MIT License
 */
(function(t,e){"function"==typeof define&&define.amd?define("ev-emitter/ev-emitter",e):"object"==typeof module&&module.exports?module.exports=e():t.EvEmitter=e()})("undefined"!=typeof window?window:this,(function(){function t(){}var e=t.prototype;return e.on=function(t,e){if(t&&e){var n=this._events=this._events||{},r=n[t]=n[t]||[];return-1==r.indexOf(e)&&r.push(e),this}},e.once=function(t,e){if(t&&e){this.on(t,e);var n=this._onceEvents=this._onceEvents||{};return(n[t]=n[t]||{})[e]=!0,this}},e.off=function(t,e){var n=this._events&&this._events[t];if(n&&n.length){var r=n.indexOf(e);return-1!=r&&n.splice(r,1),this}},e.emitEvent=function(t,e){var n=this._events&&this._events[t];if(n&&n.length){n=n.slice(0),e=e||[];for(var r=this._onceEvents&&this._onceEvents[t],i=0;i<n.length;i++){var o=n[i];r&&r[o]&&(this.off(t,o),delete r[o]),o.apply(this,e)}return this}},e.allOff=function(){delete this._events,delete this._onceEvents},t})),
/*!
 * imagesLoaded v4.1.4
 * JavaScript is all like "You images are done yet or what?"
 * MIT License
 */
(function(t,e){"function"==typeof define&&define.amd?define(["ev-emitter/ev-emitter"],(function(n){return e(t,n)})):"object"==typeof module&&module.exports?module.exports=e(t,require("ev-emitter")):t.imagesLoaded=e(t,t.EvEmitter)})("undefined"!=typeof window?window:this,(function(t,e){var n=t.jQuery,r=t.console;function i(t,e){for(var n in e)t[n]=e[n];return t}var o=Array.prototype.slice;function a(t,e,s){if(!(this instanceof a))return new a(t,e,s);var u,c=t;("string"==typeof t&&(c=document.querySelectorAll(t)),c)?(this.elements=(u=c,Array.isArray(u)?u:"object"==typeof u&&"number"==typeof u.length?o.call(u):[u]),this.options=i({},this.options),"function"==typeof e?s=e:i(this.options,e),s&&this.on("always",s),this.getImages(),n&&(this.jqDeferred=new n.Deferred),setTimeout(this.check.bind(this))):r.error("Bad element for imagesLoaded "+(c||t))}a.prototype=Object.create(e.prototype),a.prototype.options={},a.prototype.getImages=function(){this.images=[],this.elements.forEach(this.addElementImages,this)},a.prototype.addElementImages=function(t){"IMG"==t.nodeName&&this.addImage(t),!0===this.options.background&&this.addElementBackgroundImages(t);var e=t.nodeType;if(e&&s[e]){for(var n=t.querySelectorAll("img"),r=0;r<n.length;r++){var i=n[r];this.addImage(i)}if("string"==typeof this.options.background){var o=t.querySelectorAll(this.options.background);for(r=0;r<o.length;r++){var a=o[r];this.addElementBackgroundImages(a)}}}};var s={1:!0,9:!0,11:!0};function u(t){this.img=t}function c(t,e){this.url=t,this.element=e,this.img=new Image}return a.prototype.addElementBackgroundImages=function(t){var e=getComputedStyle(t);if(e)for(var n=/url\((['"])?(.*?)\1\)/gi,r=n.exec(e.backgroundImage);null!==r;){var i=r&&r[2];i&&this.addBackground(i,t),r=n.exec(e.backgroundImage)}},a.prototype.addImage=function(t){var e=new u(t);this.images.push(e)},a.prototype.addBackground=function(t,e){var n=new c(t,e);this.images.push(n)},a.prototype.check=function(){var t=this;function e(e,n,r){setTimeout((function(){t.progress(e,n,r)}))}this.progressedCount=0,this.hasAnyBroken=!1,this.images.length?this.images.forEach((function(t){t.once("progress",e),t.check()})):this.complete()},a.prototype.progress=function(t,e,n){this.progressedCount++,this.hasAnyBroken=this.hasAnyBroken||!t.isLoaded,this.emitEvent("progress",[this,t,e]),this.jqDeferred&&this.jqDeferred.notify&&this.jqDeferred.notify(this,t),this.progressedCount==this.images.length&&this.complete(),this.options.debug&&r&&r.log("progress: "+n,t,e)},a.prototype.complete=function(){var t=this.hasAnyBroken?"fail":"done";if(this.isComplete=!0,this.emitEvent(t,[this]),this.emitEvent("always",[this]),this.jqDeferred){var e=this.hasAnyBroken?"reject":"resolve";this.jqDeferred[e](this)}},u.prototype=Object.create(e.prototype),u.prototype.check=function(){this.getIsImageComplete()?this.confirm(0!==this.img.naturalWidth,"naturalWidth"):(this.proxyImage=new Image,this.proxyImage.addEventListener("load",this),this.proxyImage.addEventListener("error",this),this.img.addEventListener("load",this),this.img.addEventListener("error",this),this.proxyImage.src=this.img.src)},u.prototype.getIsImageComplete=function(){return this.img.complete&&this.img.naturalWidth},u.prototype.confirm=function(t,e){this.isLoaded=t,this.emitEvent("progress",[this,this.img,e])},u.prototype.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},u.prototype.onload=function(){this.confirm(!0,"onload"),this.unbindEvents()},u.prototype.onerror=function(){this.confirm(!1,"onerror"),this.unbindEvents()},u.prototype.unbindEvents=function(){this.proxyImage.removeEventListener("load",this),this.proxyImage.removeEventListener("error",this),this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},c.prototype=Object.create(u.prototype),c.prototype.check=function(){this.img.addEventListener("load",this),this.img.addEventListener("error",this),this.img.src=this.url,this.getIsImageComplete()&&(this.confirm(0!==this.img.naturalWidth,"naturalWidth"),this.unbindEvents())},c.prototype.unbindEvents=function(){this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},c.prototype.confirm=function(t,e){this.isLoaded=t,this.emitEvent("progress",[this,this.element,e])},a.makeJQueryPlugin=function(e){(e=e||t.jQuery)&&((n=e).fn.imagesLoaded=function(t,e){return new a(this,t,e).jqDeferred.promise(n(this))})},a.makeJQueryPlugin(),a}));
/*!
* Lightweight JSONP fetcher
* Copyright 2010-2019 Erik Arenhill. All rights reserved.
* BSD Zero Clause License
* https://github.com/erikarenhill/Lightweight-JSONP
*/
var JSONP=(function(t){var e,n=0,r={};function i(t){return encodeURIComponent(t)}return{get:function(o,a,s,u){var c,l=-1===(o||"").indexOf("?")?"?":"&";for(c in u=u||r.callbackName||"callback",r.callbackName||(u=u+"_jsonp_"+ ++n),a=a||{})a.hasOwnProperty(c)&&(l+=i(c)+"="+i(a[c])+"&");var f=!1;return t[u]=function(e){f||s(e);try{delete t[u]}catch(t){}t[u]=null},(function(t,n){var i=document.createElement("script"),o=!1,a=null;i.src=t,i.async=!0;var s=r.error;function u(){clearTimeout(a),a=null}"function"==typeof s&&(i.onerror=function(e){u(),s({url:t,event:e})}),i.onload=i.onreadystatechange=function(){o||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(o=!0,u(),i.onload=i.onreadystatechange=null,i&&i.parentNode&&i.parentNode.removeChild(i))},r.timeout&&(a=setTimeout((function(){"function"==typeof s&&(s({url:t,event:new Error("Timeout")}),n())}),r.timeout)),e||(e=document.getElementsByTagName("head")[0]),e.appendChild(i)})(o+l+"callback="+u,(function(){f=!0})),u},init:function(t){r=t}}})(window);"undefined"!=typeof module&&(module.exports=JSONP)
/*!
 * Replaces placeholders with real content
 * Requires get() - https://vanillajstoolkit.com/helpers/get/
 * See 'efm-util.js' - EFM.Util.get()
 * (c) 2019 Chris Ferdinandi, MIT License, https://gomakethings.com
 * @param {String} template The template string
 * @param {String} local    A local placeholder to use, if any
 */;var placeholders=function(t,e){if(t="function"==typeof t?t():t,-1===["string","number"].indexOf(typeof t))throw"PlaceholdersJS: please provide a valid template";return e?t=t.replace(/\{\{([^}]+)\}\}/g,(function(t){t=t.slice(2,-2);var n=EFM.Util.get(e,t);return n||"{{"+t+"}}"})):t};
/*!
 * reefjs v4.1.13
 * A lightweight helper function for creating reactive, state-based components and UI
 * (c) 2020 Chris Ferdinandi
 * MIT License
 * http://github.com/cferdinandi/reef
 */Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),(function(t,e){"function"==typeof define&&define.amd?define([],(function(){return e(t)})):"object"==typeof exports?module.exports=e(t):t.Reef=e(t)})("undefined"!=typeof global?global:"undefined"!=typeof window?window:this,(function(t){var e,n=["checked","disabled","hidden","lang","readonly","required","selected","value"],r=!1,i=function(t){return Object.prototype.toString.call(t).slice(8,-1).toLowerCase()},o=function(t){if(r)throw new Error(t)},a=function(t,e){var n=i(t);if("object"===n){var r={};for(var o in t)t.hasOwnProperty(o)&&(r[o]=a(t[o],e));return r}if("array"===n)return t.map((function(t){return a(t,e)}));if("string"===n&&!e){var s=document.createElement("div");return s.textContent=t,s.innerHTML}return t},s=function(t,e){var n=t.filter(e);return n.length<1?null:n[0]},u=function(t,e){if(!(t||e&&e.lagoon))return o("Reef.js: You did not provide an element to make into a component.");if(!e||!e.template&&!e.lagoon)return o("Reef.js: You did not provide a template for this component.");if(this.elem=t,this.data=e.data,this.template=e.template,this.allowHTML=e.allowHTML,this.attached=[],this.lagoon=e.lagoon,e.attachTo){var n=this;e.attachTo.forEach((function(t){"attach"in t&&t.attach(n)}))}},c=function(t,e){e.forEach((function(e){t.style[e]=""}))},l=function(t,e){e.forEach((function(e){if("class"===e.att)t.className=e.value;else if("style"===e.att)!(function(t,e){var n=(function(t){return t.split(";").reduce((function(t,e){if(e.indexOf(":")>0){var n=e.trim().split(":");t.push({name:n[0]?n[0].trim():"",value:n[1]?n[1].trim():""})}return t}),[])})(e),r=Array.prototype.filter.call(t.style,(function(e){return null===s(n,(function(n){return n.name===e&&n.value===t.style[e]}))}));c(t,r),(function(t,e){e.forEach((function(e){t.style[e.name]=e.value}))})(t,n)})(t,e.value);else{if(e.att in t)try{t[e.att]=e.value||e.att}catch(t){}try{t.setAttribute(e.att,e.value||"")}catch(t){}}}))},f=function(t,e){return{att:t,value:e}},p=function(t){var e=(function(t){return Array.prototype.reduce.call(t.attributes,(function(t,e){return n.indexOf(e.name)<0&&t.push(f(e.name,e.value)),t}),[])})(t);return (function(t,e){n.forEach((function(n){t[n]&&e.push(f(n,t[n]))}))})(t,e),e},h=function(t){var e;return e="text"===t.type?document.createTextNode(t.content):"comment"===t.type?document.createComment(t.content):t.isSVG?document.createElementNS("http://www.w3.org/2000/svg",t.type):document.createElement(t.type),l(e,t.atts),t.children.length>0?t.children.forEach((function(t){e.appendChild(h(t))})):"text"!==t.type&&(e.textContent=t.content),e},d=function(t,e){var n,r=e.atts.filter((function(e){return null===s(t.atts,(function(t){return e.att===t.att}))})),i=t.atts.filter((function(t){var n=s(e.atts,(function(e){return t.att===e.att}));return null===n||n.value!==t.value}));l(e.node,i),n=e.node,r.forEach((function(t){if("class"===t.att)n.className="";else if("style"===t.att)c(n,Array.prototype.slice.call(n.style));else{if(t.att in n)try{n[t.att]=""}catch(t){}try{n.removeAttribute(t.att)}catch(t){}}}))},g=function(t,e,n,r){var i=e.length-t.length;if(i>0)for(;i>0;i--)e[e.length-i].node.parentNode.removeChild(e[e.length-i].node);t.forEach((function(i,o){if(e[o])if(t[o].type===e[o].type){if(d(t[o],e[o]),!(r.filter((function(t){return 3!==i.node.nodeType&&i.node.matches(t)})).length>0))if(t[o].content&&t[o].content!==e[o].content&&(e[o].node.textContent=t[o].content),e[o].children.length>0&&i.children.length<1)e[o].node.innerHTML="";else{if(e[o].children.length<1&&i.children.length>0){var a=document.createDocumentFragment();return g(i.children,e[o].children,a,r),void e[o].node.appendChild(a)}i.children.length>0&&g(i.children,e[o].children,e[o].node,r)}}else e[o].node.parentNode.replaceChild(h(t[o]),e[o].node);else n.appendChild(h(t[o]))}))},m=function(t,e){return Array.prototype.map.call(t.childNodes,(function(t){var n={content:t.childNodes&&t.childNodes.length>0?null:t.textContent,atts:1!==t.nodeType?[]:p(t),type:3===t.nodeType?"text":8===t.nodeType?"comment":t.tagName.toLowerCase(),node:t};return n.isSVG=e||"svg"===n.type,n.children=m(t,n.isSVG),n}))},v=function(t,e){t&&t.forEach((function(t){if(t.attached.indexOf(e)>-1)return o("ReefJS: "+e.elem+" has attached nodes that it is also attached to, creating an infinite loop.");"render"in t&&t.render()}))};return u.prototype.render=function(){if(this.lagoon)v(this.attached,this);else{if(!this.template)return o("Reef.js: No template was provided.");var n="string"===i(this.elem)?document.querySelector(this.elem):this.elem;if(!n)return o("Reef.js: The DOM element to render your template into was not found.");var r=a(this.data||{},this.allowHTML),s="function"===i(this.template)?this.template(r):this.template;if(-1!==["string","number"].indexOf(i(s))&&n.innerHTML!==s.innerHTML){if(n.innerHTML.trim().length<1||s.trim().length<1)n.innerHTML=s;else{var u=m(function(t){if(e){var n=(new DOMParser).parseFromString(t,"text/html");return n.head.childNodes.length>0&&Array.prototype.slice.call(n.head.childNodes).reverse().forEach((function(t){n.body.insertBefore(t,n.body.firstChild)})),n.body}var r=document.createElement("div");return r.innerHTML=t,r}(s)),c=m(n),l=this.attached.map((function(t){return t.elem}));g(u,c,n,l)}var f;return"function"===i(t.CustomEvent)?f=new CustomEvent("render",{bubbles:!0}):(f=document.createEvent("CustomEvent")).initCustomEvent("render",!0,!1,null),n.dispatchEvent(f),v(this.attached,this),n}}},u.prototype.getData=function(){return a(this.data,!0)},u.prototype.setData=function(t){if("object"!==i(t))return o("ReefJS: The provided data is not an object.");for(var e in t)t.hasOwnProperty(e)&&(this.data[e]=t[e]);this.render()},u.prototype.attach=function(t){"array"===i(t)?Array.prototype.push.apply(this.attached,t):this.attached.push(t)},u.prototype.detach=function(t){var e="array"===i(t);this.attached=this.attached.filter((function(n){return e?-1===t.indexOf(n):n!==t}))},u.debug=function(t){r=!!t},e=(function(){if(!t.DOMParser)return!1;var e=new DOMParser;try{e.parseFromString("x","text/html")}catch(t){return!1}return!0})(),u})),(function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("ScrollBooster",[],e):"object"==typeof exports?exports.ScrollBooster=e():t.ScrollBooster=e()})(this,(function(){return (function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)})([(function(t,e,n){function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach((function(e){o(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}n.r(e),n.d(e,"default",(function(){return u}));var s=function(t){return Math.max(t.offsetHeight,t.scrollHeight)},u=(function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t);var n={content:e.viewport.children[0],direction:"all",pointerMode:"all",scrollMode:void 0,bounce:!0,bounceForce:.1,friction:.05,textSelection:!1,inputsFocus:!0,emulateScroll:!1,pointerDownPreventDefault:!0,onClick:function(){},onUpdate:function(){},shouldScroll:function(){return!0}};if(this.props=i({},n,{},e),this.props.viewport&&this.props.viewport instanceof Element)if(this.props.content){this.isDragging=!1,this.isTargetScroll=!1,this.isScrolling=!1,this.isRunning=!1;var r={x:0,y:0};this.position=i({},r),this.velocity=i({},r),this.dragStartPosition=i({},r),this.dragOffset=i({},r),this.dragPosition=i({},r),this.targetPosition=i({},r),this.scrollOffset=i({},r),this.rafID=null,this.events={},this.updateMetrics(),this.handleEvents()}else console.error("ScrollBooster init error: Viewport does not have any content");else console.error('ScrollBooster init error: "viewport" config property must be present and must be Element')}var e,n;return e=t,(n=[{key:"updateOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.props=i({},this.props,{},t),this.props.onUpdate(this.getState()),this.startAnimationLoop()}},{key:"updateMetrics",value:function(){var t;this.viewport={width:this.props.viewport.clientWidth,height:this.props.viewport.clientHeight},this.content={width:(t=this.props.content,Math.max(t.offsetWidth,t.scrollWidth)),height:s(this.props.content)},this.edgeX={from:Math.min(-this.content.width+this.viewport.width,0),to:0},this.edgeY={from:Math.min(-this.content.height+this.viewport.height,0),to:0},this.props.onUpdate(this.getState()),this.startAnimationLoop()}},{key:"startAnimationLoop",value:function(){var t=this;this.isRunning=!0,cancelAnimationFrame(this.rafID),this.rafID=requestAnimationFrame((function(){return t.animate()}))}},{key:"animate",value:function(){var t=this;if(this.isRunning){this.updateScrollPosition(),this.isMoving()||(this.isRunning=!1,this.isTargetScroll=!1);var e=this.getState();this.setContentPosition(e),this.props.onUpdate(e),this.rafID=requestAnimationFrame((function(){return t.animate()}))}}},{key:"updateScrollPosition",value:function(){this.applyEdgeForce(),this.applyDragForce(),this.applyScrollForce(),this.applyTargetForce();var t=1-this.props.friction;this.velocity.x*=t,this.velocity.y*=t,"vertical"!==this.props.direction&&(this.position.x+=this.velocity.x),"horizontal"!==this.props.direction&&(this.position.y+=this.velocity.y),this.props.bounce&&!this.isScrolling||this.isTargetScroll||(this.position.x=Math.max(Math.min(this.position.x,this.edgeX.to),this.edgeX.from),this.position.y=Math.max(Math.min(this.position.y,this.edgeY.to),this.edgeY.from))}},{key:"applyForce",value:function(t){this.velocity.x+=t.x,this.velocity.y+=t.y}},{key:"applyEdgeForce",value:function(){if(this.props.bounce&&!this.isDragging){var t=this.position.x<this.edgeX.from,e=this.position.x>this.edgeX.to,n=this.position.y<this.edgeY.from,r=this.position.y>this.edgeY.to,i=t||e,o=n||r;if(i||o){var a=t?this.edgeX.from:this.edgeX.to,s=n?this.edgeY.from:this.edgeY.to,u=a-this.position.x,c=s-this.position.y,l={x:u*this.props.bounceForce,y:c*this.props.bounceForce},f=this.position.x+(this.velocity.x+l.x)/this.props.friction,p=this.position.y+(this.velocity.y+l.y)/this.props.friction;(t&&f>=this.edgeX.from||e&&f<=this.edgeX.to)&&(l.x=u*this.props.bounceForce-this.velocity.x),(n&&p>=this.edgeY.from||r&&p<=this.edgeY.to)&&(l.y=c*this.props.bounceForce-this.velocity.y),this.applyForce({x:i?l.x:0,y:o?l.y:0})}}}},{key:"applyDragForce",value:function(){if(this.isDragging){var t=this.dragPosition.x-this.position.x,e=this.dragPosition.y-this.position.y;this.applyForce({x:t-this.velocity.x,y:e-this.velocity.y})}}},{key:"applyScrollForce",value:function(){this.isScrolling&&(this.applyForce({x:this.scrollOffset.x-this.velocity.x,y:this.scrollOffset.y-this.velocity.y}),this.scrollOffset.x=0,this.scrollOffset.y=0)}},{key:"applyTargetForce",value:function(){this.isTargetScroll&&this.applyForce({x:.08*(this.targetPosition.x-this.position.x)-this.velocity.x,y:.08*(this.targetPosition.y-this.position.y)-this.velocity.y})}},{key:"isMoving",value:function(){return this.isDragging||this.isScrolling||Math.abs(this.velocity.x)>=.01||Math.abs(this.velocity.y)>=.01}},{key:"scrollTo",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.isTargetScroll=!0,this.targetPosition.x=-t.x||0,this.targetPosition.y=-t.y||0,this.startAnimationLoop()}},{key:"setPosition",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.velocity.x=0,this.velocity.y=0,this.position.x=-t.x||0,this.position.y=-t.y||0,this.startAnimationLoop()}},{key:"getState",value:function(){return{isMoving:this.isMoving(),isDragging:!(!this.dragOffset.x&&!this.dragOffset.y),position:{x:-this.position.x,y:-this.position.y},dragOffset:this.dragOffset,borderCollision:{left:this.position.x>=this.edgeX.to,right:this.position.x<=this.edgeX.from,top:this.position.y>=this.edgeY.to,bottom:this.position.y<=this.edgeY.from}}}},{key:"setContentPosition",value:function(t){"transform"===this.props.scrollMode&&(this.props.content.style.transform="translate(".concat(-t.position.x,"px, ").concat(-t.position.y,"px)")),"native"===this.props.scrollMode&&(this.props.viewport.scrollTop=t.position.y,this.props.viewport.scrollLeft=t.position.x)}},{key:"handleEvents",value:function(){var t=this,e={x:0,y:0},n=null,r=!1,i=function(n){if(t.isDragging){var i=r?n.touches[0].pageX:n.pageX,o=r?n.touches[0].pageY:n.pageY;t.dragOffset.x=i-e.x,t.dragOffset.y=o-e.y,t.dragPosition.x=t.dragStartPosition.x+t.dragOffset.x,t.dragPosition.y=t.dragStartPosition.y+t.dragOffset.y}};this.events.pointerdown=function(n){var o=(r=!(!n.touches||!n.touches[0]))?n.touches[0]:n,a=o.pageX,s=o.pageY,u=o.clientX,c=o.clientY,l=t.props.viewport,f=l.getBoundingClientRect();if(!(u-f.left>=l.clientLeft+l.clientWidth)&&!(c-f.top>=l.clientTop+l.clientHeight)&&t.props.shouldScroll(t.getState(),n)&&2!==n.button&&("mouse"!==t.props.pointerMode||!r)&&("touch"!==t.props.pointerMode||r)&&!(t.props.inputsFocus&&["input","textarea","button","select","label"].indexOf(n.target.nodeName.toLowerCase())>-1)){if(t.props.textSelection){if(function(t,e,n){for(var r=t.childNodes,i=document.createRange(),o=0;o<r.length;o++){var a=r[o];if(3===a.nodeType){i.selectNodeContents(a);var s=i.getBoundingClientRect();if(e>=s.left&&n>=s.top&&e<=s.right&&n<=s.bottom)return a}}return!1}(n.target,u,c))return;(p=window.getSelection?window.getSelection():document.selection)&&(p.removeAllRanges?p.removeAllRanges():p.empty&&p.empty())}var p;t.isDragging=!0,e.x=a,e.y=s,t.dragStartPosition.x=t.position.x,t.dragStartPosition.y=t.position.y,i(n),t.startAnimationLoop(),t.props.pointerDownPreventDefault&&n.preventDefault()}},this.events.pointermove=function(t){i(t)},this.events.pointerup=function(){t.isDragging=!1},this.events.wheel=function(e){t.props.emulateScroll&&(t.velocity.x=0,t.velocity.y=0,t.isScrolling=!0,t.scrollOffset.x=-e.deltaX,t.scrollOffset.y=-e.deltaY,t.startAnimationLoop(),clearTimeout(n),n=setTimeout((function(){return t.isScrolling=!1}),80),e.preventDefault())},this.events.scroll=function(){var e=t.props.viewport,n=e.scrollLeft,r=e.scrollTop;Math.abs(t.position.x+n)>3&&(t.position.x=-n,t.velocity.x=0),Math.abs(t.position.y+r)>3&&(t.position.y=-r,t.velocity.y=0)},this.events.click=function(e){var n=t.getState(),r="vertical"!==t.props.direction?n.dragOffset.x:0,i="horizontal"!==t.props.direction?n.dragOffset.y:0;Math.max(Math.abs(r),Math.abs(i))>5&&(e.preventDefault(),e.stopPropagation()),t.props.onClick(n,e)},this.events.contentLoad=function(){return t.updateMetrics()},this.events.resize=function(){return t.updateMetrics()},this.props.viewport.addEventListener("mousedown",this.events.pointerdown),this.props.viewport.addEventListener("touchstart",this.events.pointerdown),this.props.viewport.addEventListener("click",this.events.click),this.props.viewport.addEventListener("wheel",this.events.wheel),this.props.viewport.addEventListener("scroll",this.events.scroll),this.props.content.addEventListener("load",this.events.contentLoad,!0),window.addEventListener("mousemove",this.events.pointermove),window.addEventListener("touchmove",this.events.pointermove),window.addEventListener("mouseup",this.events.pointerup),window.addEventListener("touchend",this.events.pointerup),window.addEventListener("resize",this.events.resize)}},{key:"destroy",value:function(){this.props.viewport.removeEventListener("mousedown",this.events.pointerdown),this.props.viewport.removeEventListener("touchstart",this.events.pointerdown),this.props.viewport.removeEventListener("click",this.events.click),this.props.viewport.removeEventListener("wheel",this.events.wheel),this.props.viewport.removeEventListener("scroll",this.events.scroll),this.props.content.removeEventListener("load",this.events.contentLoad),window.removeEventListener("mousemove",this.events.pointermove),window.removeEventListener("touchmove",this.events.pointermove),window.removeEventListener("mouseup",this.events.pointerup),window.removeEventListener("touchend",this.events.pointerup),window.removeEventListener("resize",this.events.resize)}}])&&a(e.prototype,n),t})()})]).default}));